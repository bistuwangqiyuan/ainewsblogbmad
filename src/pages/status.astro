---
import Layout from '../layouts/Layout.astro';

const title = '服务状态';
const description = 'AI新闻博客服务状态监控，实时查看系统运行状况';
---

<Layout title={title} description={description}>
    <div class="min-h-screen bg-gray-900">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- 页面标题 -->
            <div class="text-center mb-12">
                <h1 class="text-3xl font-bold text-white mb-4">服务状态</h1>
                <p class="text-gray-400 text-lg">实时监控系统运行状况和服务可用性</p>
            </div>

            <!-- 整体状态概览 -->
            <div class="bg-gray-800 rounded-lg p-8 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-white">整体状态</h2>
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-green-400 font-semibold">所有系统运行正常</span>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-green-400">99.9%</div>
                        <div class="text-gray-400">正常运行时间</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-blue-400">12ms</div>
                        <div class="text-gray-400">平均响应时间</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-purple-400">1,234</div>
                        <div class="text-gray-400">今日活跃用户</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-yellow-400">56</div>
                        <div class="text-gray-400">今日新闻更新</div>
                    </div>
                </div>
            </div>

            <!-- 服务状态列表 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- 核心服务 -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-xl font-bold text-white mb-6">核心服务</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">网站前端</div>
                                    <div class="text-gray-400 text-sm">用户界面和页面加载</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">数据库服务</div>
                                    <div class="text-gray-400 text-sm">Supabase PostgreSQL</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">认证服务</div>
                                    <div class="text-gray-400 text-sm">用户登录和注册</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">文件存储</div>
                                    <div class="text-gray-400 text-sm">图片和文件上传</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>
                    </div>
                </div>

                <!-- 功能服务 -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-xl font-bold text-white mb-6">功能服务</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">新闻采集</div>
                                    <div class="text-gray-400 text-sm">自动RSS新闻抓取</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">AI问答</div>
                                    <div class="text-gray-400 text-sm">智能编程助手</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">实时通知</div>
                                    <div class="text-gray-400 text-sm">消息推送服务</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <div class="text-white font-semibold">搜索功能</div>
                                    <div class="text-gray-400 text-sm">内容搜索和筛选</div>
                                </div>
                            </div>
                            <div class="text-green-400 text-sm">正常</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 历史状态 -->
            <div class="mt-8 bg-gray-800 rounded-lg p-6">
                <h3 class="text-xl font-bold text-white mb-6">历史状态</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="border-b border-gray-700">
                                <th class="py-3 px-4 text-gray-300 font-semibold">时间</th>
                                <th class="py-3 px-4 text-gray-300 font-semibold">服务</th>
                                <th class="py-3 px-4 text-gray-300 font-semibold">状态</th>
                                <th class="py-3 px-4 text-gray-300 font-semibold">描述</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 text-gray-400">2024-01-15 14:30</td>
                                <td class="py-3 px-4 text-white">新闻采集</td>
                                <td class="py-3 px-4">
                                    <span class="px-2 py-1 bg-green-600 text-white text-xs rounded">正常</span>
                                </td>
                                <td class="py-3 px-4 text-gray-400">成功采集20条新闻</td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 text-gray-400">2024-01-15 10:15</td>
                                <td class="py-3 px-4 text-white">数据库服务</td>
                                <td class="py-3 px-4">
                                    <span class="px-2 py-1 bg-green-600 text-white text-xs rounded">正常</span>
                                </td>
                                <td class="py-3 px-4 text-gray-400">连接稳定，性能良好</td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 text-gray-400">2024-01-15 08:00</td>
                                <td class="py-3 px-4 text-white">AI问答</td>
                                <td class="py-3 px-4">
                                    <span class="px-2 py-1 bg-green-600 text-white text-xs rounded">正常</span>
                                </td>
                                <td class="py-3 px-4 text-gray-400">响应时间12ms</td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-4 text-gray-400">2024-01-14 23:45</td>
                                <td class="py-3 px-4 text-white">网站前端</td>
                                <td class="py-3 px-4">
                                    <span class="px-2 py-1 bg-green-600 text-white text-xs rounded">正常</span>
                                </td>
                                <td class="py-3 px-4 text-gray-400">页面加载速度优化</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 性能指标 -->
            <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-gray-800 rounded-lg p-6">
                    <h4 class="text-lg font-semibold text-white mb-4">响应时间</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">首页</span>
                            <span class="text-green-400">245ms</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">新闻页面</span>
                            <span class="text-green-400">189ms</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">社区页面</span>
                            <span class="text-green-400">312ms</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-800 rounded-lg p-6">
                    <h4 class="text-lg font-semibold text-white mb-4">错误率</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">4xx错误</span>
                            <span class="text-yellow-400">0.02%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">5xx错误</span>
                            <span class="text-green-400">0.00%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">超时</span>
                            <span class="text-green-400">0.01%</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-800 rounded-lg p-6">
                    <h4 class="text-lg font-semibold text-white mb-4">资源使用</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">CPU使用率</span>
                            <span class="text-green-400">23%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">内存使用率</span>
                            <span class="text-green-400">45%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">磁盘使用率</span>
                            <span class="text-green-400">67%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 订阅状态更新 -->
            <div class="mt-8 bg-gray-800 rounded-lg p-6">
                <h3 class="text-xl font-bold text-white mb-4">订阅状态更新</h3>
                <p class="text-gray-400 mb-4">获取服务状态变更通知</p>
                <div class="flex flex-col sm:flex-row gap-4">
                    <input
                        type="email"
                        placeholder="输入您的邮箱地址"
                        class="flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <button class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors"> 订阅 </button>
                </div>
            </div>

            <!-- 最后更新时间 -->
            <div class="mt-8 text-center text-gray-400 text-sm">
                最后更新时间：<span id="last-update"></span>
            </div>
        </div>
    </div>

    <script>
        // 更新最后更新时间
        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('last-update').textContent = timeString;
        }

        // 页面加载时更新时间
        updateLastUpdateTime();

        // 每分钟更新一次时间
        setInterval(updateLastUpdateTime, 60000);

        // 模拟实时状态检查
        function checkServiceStatus() {
            // 这里可以添加实际的API调用来检查服务状态
            console.log('检查服务状态...');
        }

        // 每30秒检查一次服务状态
        setInterval(checkServiceStatus, 30000);

        // 订阅功能
        const subscribeButton = document.querySelector('button');
        const emailInput = document.querySelector('input[type="email"]');

        subscribeButton.addEventListener('click', () => {
            const email = emailInput.value.trim();
            if (email && email.includes('@')) {
                alert('订阅成功！您将收到服务状态更新通知。');
                emailInput.value = '';
            } else {
                alert('请输入有效的邮箱地址。');
            }
        });
    </script>
</Layout>
