# AI 编程新闻与社区产品需求文档 (PRD)

- 文档版本：v4.0
- 创建日期：2025-08-31
- 最后更新：2025-08-31
- 作者：John (PM)

## 1. 目标与背景上下文

### 1.1 目标

- 建立中文 AI 编程新闻聚合平台，每日自动抓取 100+ 条高质量新闻
- 构建轻量级社区互动系统，支持发帖、评论、点赞、收藏等基础功能
- 实现 AI 专家问答功能，提供公开的 AI 辅助编程支持
- 建立用户积分与等级体系，激励用户参与和贡献
- 提供完整的用户认证、个人中心、消息通知系统
- 确保平台简洁易用，移动端友好，符合现代 Web 标准

### 1.2 背景上下文

AI 与编程领域正经历前所未有的信息爆炸，个人开发者面临着信息过载的挑战。现有的技术新闻平台要么过于宽泛，要么缺乏针对 AI 编程的专业聚焦。同时，中文开发者社区缺少一个既能提供高质量 AI 编程资讯，又能支持轻量级互动讨论的平台。

本项目旨在解决这一痛点，通过自动化的新闻聚合、去重和分类，为中文开发者提供精准的 AI 编程相关信息。平台采用 Supabase 作为后端服务，确保数据安全和用户隐私，同时通过 Netlify 实现高效的部署和运维。整个系统设计遵循"简洁、高效、用户友好"的原则，避免功能过度复杂化。

### 1.3 变更日志

| 日期 | 版本 | 描述 | 作者 |
|------|------|------|------|
| 2025-08-31 | v4.0 | 完整 PRD 创建，包含所有功能模块 | John (PM) |

## 2. 需求

### 2.1 功能需求

**FR1:** 用户认证系统 - 支持邮箱密码注册登录，基于 Supabase Auth 实现，会话持久化

**FR2:** 新闻聚合与展示 - 自动抓取 20 个来源的 AI 编程新闻，支持筛选、搜索、分页（20条/页，最大50页）

**FR3:** 社区发帖系统 - 支持用户发布帖子、提问，上传图片/视频（≤10MB，最多5个），同一数据结构下分为论坛和问答两个标签

**FR4:** 互动功能 - 点赞（可取消）、收藏（不可删除）、评论（仅一级，不可编辑/删除）、举报（文本原因）

**FR5:** AI 问答系统 - 公开的 AI 专家问答，调用外部 AI API，失败时明确报错不使用回退机制

**FR6:** 积分等级体系 - 基于用户行为的积分计算和等级展示（Lv1-5，0/50/150/400/1000阈值）

**FR7:** 个人中心 - 用户资料、统计信息（发帖/评论/收藏计数）、积分记录展示

**FR8:** 消息通知系统 - 私信、系统通知功能，支持已读/未读状态

**FR9:** 敏感词过滤 - 前端 RPC 预检 + 数据库触发器强校验，命中直接拒写并提示

**FR10:** 数据统计 - 浏览量记录、个人行为统计、积分变更记录

**FR11:** 反馈系统 - 用户反馈提交，支持文本和附件（≤10MB）

**FR12:** 内容管理 - 新闻去重（sha1哈希）、内容分类、标签管理

**FR13:** 搜索筛选 - 按来源、时间、关键词筛选，时间优先排序

**FR14:** 媒体管理 - 图片（jpg/png/webp）、视频（mp4）上传至 Supabase Storage

### 2.2 非功能需求

**NFR1:** 性能要求 - 新闻列表加载时间 ≤2秒，支持 20 条/页分页，关键查询建立索引

**NFR2:** 安全要求 - 最小权限原则，RLS 策略保护用户数据，Storage 写入路径隔离

**NFR3:** 可用性要求 - 99.5% 服务可用性，移动端响应式设计，WCAG AA 可访问性

**NFR4:** 数据要求 - 每日抓取 ≥100 条新闻，去重后入库，失败源记录日志

**NFR5:** 存储要求 - 图片/视频文件 ≤10MB，支持 jpg/png/webp/mp4 格式

**NFR6:** 扩展性要求 - 支持未来功能扩展，模块化架构设计

**NFR7:** 运维要求 - 定时任务日志化，失败源可定位，环境变量管理敏感信息

## 3. 用户界面设计目标

### 3.1 整体 UX 愿景

简洁明快的现代 Web 界面，专注于内容展示和用户交互。采用卡片式布局，清晰的视觉层次，确保信息密度适中。移动端优先的响应式设计，确保在各种设备上的良好体验。

### 3.2 关键交互范式

- **卡片式浏览** - 新闻和帖子采用卡片布局，支持快速浏览
- **标签页切换** - 社区页面使用标签页区分论坛和问答
- **无限滚动** - 新闻列表支持无限滚动加载
- **模态框交互** - 登录、发帖等操作使用模态框
- **实时反馈** - 点赞、收藏等操作提供即时视觉反馈

### 3.3 核心屏幕和视图

- **首页** - 网站介绍与关键入口
- **新闻流** - 筛选/搜索/分页的新闻列表
- **新闻详情** - 完整内容展示与互动功能
- **社区** - 论坛和问答的统一界面
- **发帖/提问** - 内容创作界面
- **帖子详情** - 内容展示与评论系统
- **AI 问答** - AI 专家问答界面
- **登录注册** - 用户认证界面
- **个人中心** - 用户资料与统计
- **消息中心** - 私信与系统通知
- **反馈页面** - 用户反馈提交

### 3.4 可访问性

**WCAG AA** - 确保良好的对比度、键盘导航支持、屏幕阅读器兼容性

### 3.5 品牌

简洁明快的技术风格，对比度良好，可读性优先。主题色沿用当前样式，后续可细化。

### 3.6 目标设备和平台

**Web 响应式** - 支持桌面、平板、手机等所有设备

## 4. 技术假设

### 4.1 仓库结构

**Monorepo** - 单一仓库包含前端、函数、配置等所有代码

### 4.2 服务架构

**Serverless** - 基于 Netlify Functions 和 Supabase 的无服务器架构

### 4.3 测试要求

**单元 + 集成** - 前端单元测试 + 后端集成测试，包含 API 测试

### 4.4 额外技术假设和请求

- **前端框架**: Astro + 原生 HTML/CSS/JS，不使用 TypeScript
- **后端服务**: Supabase（Postgres + Auth + Storage + RLS）
- **部署平台**: Netlify（静态托管 + Functions + 调度任务）
- **AI 集成**: OpenAI 兼容 API 调用
- **数据抓取**: RSS 聚合 + 定时函数
- **文件存储**: Supabase Storage，公开读、本人写、禁删策略
- **权限管理**: Supabase RLS 策略
- **敏感词过滤**: 前端预检 + 数据库触发器
- **积分系统**: 数据库触发器自动计算
- **消息系统**: 实时通知（可选 WebSocket）

## 5. 史诗列表

**Epic 1: 基础架构与用户认证** - 建立项目基础架构，实现用户注册登录系统，搭建核心数据模型

**Epic 2: 新闻聚合与展示** - 实现新闻抓取、去重、存储和展示功能，支持筛选搜索分页

**Epic 3: 社区互动系统** - 构建发帖、评论、点赞、收藏、举报等互动功能

**Epic 4: AI 问答与个人中心** - 实现 AI 专家问答功能，完善个人中心和积分等级系统

**Epic 5: 消息通知与反馈** - 建立站内消息、系统通知和用户反馈系统

## 6. 史诗详情

### Epic 1: 基础架构与用户认证

**目标**: 建立项目基础架构，实现用户注册登录系统，搭建核心数据模型。为后续功能开发奠定坚实基础，确保用户能够安全注册和登录系统。

#### Story 1.1: 项目基础架构搭建

作为开发者，
我想要建立完整的项目基础架构，
以便能够开始功能开发。

**验收标准:**
1. Astro 项目初始化完成，包含基础页面结构
2. Supabase 项目配置完成，包含环境变量设置
3. Netlify 部署配置完成，支持自动部署
4. 基础样式和布局组件创建完成
5. 项目文档和 README 更新完成

#### Story 1.2: 数据库模型设计

作为系统架构师，
我想要设计完整的数据库模型，
以便支持所有业务功能。

**验收标准:**
1. 用户表（profiles）设计完成，包含必要字段
2. 新闻表（news_items）设计完成，支持去重和分类
3. 帖子表（posts）设计完成，支持论坛和问答
4. 互动表（likes, favorites, comments）设计完成
5. 其他辅助表（views, points_log, messages等）设计完成
6. RLS 策略设计完成，确保数据安全

#### Story 1.3: 用户认证系统

作为用户，
我想要通过邮箱密码注册和登录，
以便能够使用系统的个人功能。

**验收标准:**
1. 注册页面创建完成，支持邮箱密码注册
2. 登录页面创建完成，支持邮箱密码登录
3. 用户会话管理实现完成，支持持久化登录
4. 用户资料页面创建完成，支持基本信息编辑
5. 登出功能实现完成
6. 未登录用户访问限制实现完成

### Epic 2: 新闻聚合与展示

**目标**: 实现新闻抓取、去重、存储和展示功能，支持筛选搜索分页。为用户提供高质量的 AI 编程新闻内容，确保内容的及时性和准确性。

#### Story 2.1: 新闻抓取系统

作为系统管理员，
我想要自动抓取多个来源的 AI 编程新闻，
以便为用户提供丰富的内容。

**验收标准:**
1. 20个新闻源配置完成，包含 RSS 和 API 源
2. 定时抓取函数实现完成，每日执行
3. 新闻去重逻辑实现完成，基于哈希值
4. 新闻分类和标签系统实现完成
5. 抓取日志记录系统实现完成
6. 错误处理和重试机制实现完成

#### Story 2.2: 新闻列表展示

作为用户，
我想要浏览新闻列表，
以便了解最新的 AI 编程动态。

**验收标准:**
1. 新闻列表页面创建完成，支持卡片式布局
2. 分页功能实现完成，20条/页
3. 时间排序功能实现完成，最新优先
4. 响应式设计实现完成，支持移动端
5. 加载状态和错误处理实现完成
6. 新闻预览功能实现完成

#### Story 2.3: 新闻筛选和搜索

作为用户，
我想要按条件筛选和搜索新闻，
以便快速找到感兴趣的内容。

**验收标准:**
1. 按来源筛选功能实现完成
2. 按时间范围筛选功能实现完成
3. 按关键词搜索功能实现完成
4. 筛选条件组合功能实现完成
5. 搜索历史记录功能实现完成
6. 筛选结果统计显示实现完成

#### Story 2.4: 新闻详情页面

作为用户，
我想要查看新闻的完整内容，
以便深入了解具体信息。

**验收标准:**
1. 新闻详情页面创建完成
2. 新闻内容完整展示实现完成
3. 来源链接跳转功能实现完成
4. 浏览量统计功能实现完成
5. 分享功能实现完成
6. 相关新闻推荐功能实现完成

### Epic 3: 社区互动系统

**目标**: 构建发帖、评论、点赞、收藏、举报等互动功能。为用户提供丰富的社区互动体验，促进用户参与和内容分享。

#### Story 3.1: 社区发帖系统

作为用户，
我想要发布帖子和提问，
以便与社区其他用户交流。

**验收标准:**
1. 发帖页面创建完成，支持富文本编辑
2. 图片/视频上传功能实现完成（≤10MB，最多5个）
3. 帖子类型选择功能实现完成（论坛/问答）
4. 帖子预览功能实现完成
5. 帖子发布成功提示实现完成
6. 草稿保存功能实现完成

#### Story 3.2: 社区列表展示

作为用户，
我想要浏览社区内容，
以便参与讨论和获取帮助。

**验收标准:**
1. 社区首页创建完成，支持标签页切换
2. 论坛标签页实现完成，显示用户发帖
3. 问答标签页实现完成，显示用户提问
4. 帖子排序功能实现完成（时间/热度）
5. 帖子分类筛选功能实现完成
6. 帖子搜索功能实现完成

#### Story 3.3: 帖子详情页面

作为用户，
我想要查看帖子的详细内容和回复，
以便参与讨论。

**验收标准:**
1. 帖子详情页面创建完成
2. 帖子内容完整展示实现完成
3. 媒体文件展示功能实现完成
4. 帖子作者信息显示实现完成
5. 帖子发布时间显示实现完成
6. 帖子编辑功能实现完成（仅作者）

#### Story 3.4: 评论系统

作为用户，
我想要对帖子进行评论，
以便参与讨论。

**验收标准:**
1. 评论列表展示功能实现完成
2. 评论发布功能实现完成
3. 评论时间显示实现完成
4. 评论作者信息显示实现完成
5. 评论分页功能实现完成
6. 评论举报功能实现完成

#### Story 3.5: 点赞和收藏系统

作为用户，
我想要点赞和收藏内容，
以便表达喜好和保存内容。

**验收标准:**
1. 点赞功能实现完成，支持取消
2. 收藏功能实现完成，不支持删除
3. 点赞状态显示实现完成
4. 收藏状态显示实现完成
5. 点赞数量统计显示实现完成
6. 收藏数量统计显示实现完成

#### Story 3.6: 举报系统

作为用户，
我想要举报不当内容，
以便维护社区环境。

**验收标准:**
1. 举报功能实现完成，支持文本原因
2. 举报记录存储功能实现完成
3. 举报成功提示实现完成
4. 举报历史查看功能实现完成
5. 举报处理状态显示实现完成
6. 举报反馈功能实现完成

### Epic 4: AI 问答与个人中心

**目标**: 实现 AI 专家问答功能，完善个人中心和积分等级系统。为用户提供智能化的问答服务，同时建立完善的用户成长体系。

#### Story 4.1: AI 问答系统

作为用户，
我想要向 AI 提问，
以便获得编程相关的帮助。

**验收标准:**
1. AI 问答页面创建完成
2. 问题输入界面实现完成
3. AI 回答展示功能实现完成
4. 问题历史记录功能实现完成
5. 问题分享功能实现完成
6. 错误处理机制实现完成

#### Story 4.2: 积分等级系统

作为用户，
我想要通过参与获得积分和等级，
以便展示我的贡献。

**验收标准:**
1. 积分计算规则实现完成
2. 等级划分系统实现完成
3. 积分获取记录功能实现完成
4. 等级显示功能实现完成
5. 积分历史查看功能实现完成
6. 积分排行榜功能实现完成

#### Story 4.3: 个人中心

作为用户，
我想要查看和管理我的个人信息，
以便了解我的活动状态。

**验收标准:**
1. 个人中心页面创建完成
2. 用户资料编辑功能实现完成
3. 个人统计信息显示实现完成
4. 活动历史记录功能实现完成
5. 个人设置功能实现完成
6. 账户安全设置功能实现完成

#### Story 4.4: 敏感词过滤

作为系统管理员，
我想要过滤不当内容，
以便维护社区环境。

**验收标准:**
1. 敏感词库管理功能实现完成
2. 前端预检功能实现完成
3. 后端强校验功能实现完成
4. 敏感词命中提示实现完成
5. 敏感词统计功能实现完成
6. 敏感词更新机制实现完成

### Epic 5: 消息通知与反馈

**目标**: 建立站内消息、系统通知和用户反馈系统。为用户提供完善的沟通渠道，支持用户反馈和系统通知。

#### Story 5.1: 站内消息系统

作为用户，
我想要与其他用户私信交流，
以便进行深度讨论。

**验收标准:**
1. 消息列表页面创建完成
2. 私信发送功能实现完成
3. 私信接收功能实现完成
4. 消息已读/未读状态实现完成
5. 消息搜索功能实现完成
6. 消息删除功能实现完成

#### Story 5.2: 系统通知

作为用户，
我想要接收系统通知，
以便了解重要信息。

**验收标准:**
1. 通知列表页面创建完成
2. 通知类型分类功能实现完成
3. 通知已读/未读状态实现完成
4. 通知设置功能实现完成
5. 通知推送功能实现完成
6. 通知历史记录功能实现完成

#### Story 5.3: 用户反馈系统

作为用户，
我想要提交反馈和建议，
以便帮助改进系统。

**验收标准:**
1. 反馈页面创建完成
2. 反馈类型选择功能实现完成
3. 反馈内容输入功能实现完成
4. 附件上传功能实现完成（≤10MB）
5. 反馈提交成功提示实现完成
6. 反馈历史查看功能实现完成

#### Story 5.4: 数据统计和监控

作为系统管理员，
我想要监控系统运行状态，
以便及时发现问题。

**验收标准:**
1. 用户行为统计功能实现完成
2. 内容统计功能实现完成
3. 系统性能监控功能实现完成
4. 错误日志记录功能实现完成
5. 统计报表生成功能实现完成
6. 监控告警功能实现完成

## 7. 检查结果报告

### 7.1 需求完整性检查

✅ 所有核心功能需求已覆盖
✅ 非功能需求已明确
✅ 用户界面设计目标已定义
✅ 技术假设已确定
✅ 史诗和故事已详细规划

### 7.2 技术可行性检查

✅ Supabase 技术栈适用性确认
✅ Netlify 部署方案可行性确认
✅ AI API 集成方案确认
✅ 数据抓取技术方案确认

### 7.3 用户体验检查

✅ 用户旅程完整性确认
✅ 交互设计合理性确认
✅ 可访问性要求确认
✅ 响应式设计要求确认

## 8. 下一步

### 8.1 UX 专家提示

请基于此 PRD 创建详细的用户界面设计规范，包括：
- 页面布局和导航设计
- 组件库和设计系统
- 交互原型和用户流程
- 可访问性设计指南
- 响应式设计规范

### 8.2 架构师提示

请基于此 PRD 创建详细的技术架构文档，包括：
- 系统架构设计
- 数据库设计详细方案
- API 接口设计
- 安全策略和权限控制
- 部署和运维方案
- 性能优化策略
